<script>
$(function() {
var searchBox = $( "#searchBox" ),
searchLink = $("#go_search_results");

  function onSuccess(return_obj) {
    var searchNumber = return_obj[0].length + return_obj[1].length;
    if(searchNumber > 0) {
      searchLink.text('Search (' + searchNumber + ')');
      google.script.run.withSuccessHandler(createTable).getMyCreatedTasks("searchcreateown", "creator", "asc", return_obj[0]);
      google.script.run.withSuccessHandler(createTable).getMyCreatedTasks("searchassignee", "creator", "asc", return_obj[1]);
    } else {
      searchLink.text('Search (No Results)');
    }
    $('#SearchAssignedHeader').text( 'Tasks Assigned To Me (' + return_obj[1].length + ')' );
    $('#SearchOwnedHeader').text( 'Tasks Created/Owned By Me (' + return_obj[0].length + ')' );
  }
  $( searchLink ).click(function(){
    $(this).text('Searching...');
    $( "#search_results_table tbody" ).find("tr").remove();
    $( "#search_results_assignee_table tbody" ).find("tr").remove();
    google.script.run.withSuccessHandler(onSuccess).getSearchResults(searchBox.val()); 
  });
  $( searchBox ).bind('keypress', function(e) {
    if(e.keyCode==13) { //Enter keycode
      $(searchLink).text('Searching...');
      $( "#search_results_table tbody" ).find("tr").remove();
      $( "#search_results_assignee_table tbody" ).find("tr").remove();
      google.script.run.withSuccessHandler(onSuccess).getSearchResults(searchBox.val()); 
    }
  });
});
</script>