<script>
//tips text updater used in each validation portion
function updateTips( t, tipsName ) {
  var tips = $( tipsName );
  tips.text( t );
  tips.addClass( "tips_error_msg" );
}

//validate email addresses
  function checkEmail(element, eleDisplayName, tip, autocomplete) {
  var emailFilter=/^.+@.+\..+$/
  var illegalChars= /[\(\)\<\>\,\;\:\\\"\[\]]/
  if(autocomplete) {
    var value = autocomplete;
  } else {
    var value = element.val();
  }
  if (value.length == 0) {
    if (element.closest( "form" ).attr("id") == "taskForm" || element.parent().parent().parent().closest( "div" ).parent().parent().attr("id") == "more-info-dialog" ) { tip.removeClass( "ui-icon ui-icon-check" ); }
    element.addClass( "ui-state-error" );
//    element.focus();
    return eleDisplayName + " is required.";
  } else if (!(emailFilter.test(value))) { 
    if (element.closest( "form" ).attr("id") == "taskForm" || element.parent().parent().parent().closest( "div" ).parent().parent().attr("id") == "more-info-dialog" ) { tip.removeClass( "ui-icon ui-icon-check" ); }
    element.addClass( "ui-state-error" );
    return "Please enter a valid email address.";
  } else if (value.match(illegalChars)) {
    if (element.closest( "form" ).attr("id") == "taskForm" || element.parent().parent().parent().closest( "div" ).parent().parent().attr("id") == "more-info-dialog" ) { tip.removeClass( "ui-icon ui-icon-check" ); }
    element.addClass( "ui-state-error" );
    return "The email address contains illegal characters.";
  } else {
    if (element.closest( "form" ).attr("id") == "taskForm" || element.parent().parent().parent().closest( "div" ).parent().parent().attr("id") == "more-info-dialog" ) { tip.addClass( "ui-icon ui-icon-check tips_error_msg" ); element.addClass( "ui-state-default" );}
    element.removeClass( "ui-state-error" );
    return true;
  }  
  }
  
//look for blanks in certain fields, then show an error message. If all is okay, then show that.
  function checkForBlankFields(element, elementDisplayName, tip) {    
    if (element.val().length == 0) {
      if (element.closest( "form" ).attr("id") == "taskForm" || element.parent().parent().parent().closest( "div" ).parent().parent().attr("id") == "more-info-dialog" || element.attr("id") == "edit-completion-date") { tip.removeClass( "ui-icon ui-icon-check" );}
      element.addClass( "ui-state-error" );
//      element.focus();
      return elementDisplayName + " is required.";
    } else {
      if (element.closest( "form" ).attr("id") == "taskForm" || element.parent().parent().parent().closest( "div" ).parent().parent().attr("id") == "more-info-dialog" || element.attr("id") == "edit-completion-date") { tip.addClass( "ui-icon ui-icon-check tips_error_msg" ); element.addClass( "ui-state-default" );}
      element.removeClass( "ui-state-error" );
      return true;
    }
  }
  
//generic function to count # of a variable special character in a string
  function checkSpecialChar(element, elementDisplayName, tip, character, count) {
    var characterCount = element.val().split(character).length-1;
    if(characterCount > count) {
      count++
      element.removeClass( "ui-state-default" );
      element.addClass( "ui-state-error" );
//      element.focus();
      if (element.closest( "form" ).attr("id") == "taskForm" || element.parent().parent().parent().closest( "div" ).parent().parent().attr("id") == "more-info-dialog" ) { tip.removeClass( "ui-icon ui-icon-check tips_error_msg" ); }
      return "You may only have " + count + ' ' + elementDisplayName + ' in this field.';
    } else if(element.val().length == 0) {
      if (element.closest( "form" ).attr("id") == "taskForm" || element.parent().parent().parent().closest( "div" ).parent().parent().attr("id") == "more-info-dialog" ) { tip.removeClass( "ui-icon ui-icon-check" ); }
      element.addClass( "ui-state-error" );
//      element.focus();
      return elementDisplayName + " is required.";
    } else {
      if (element.closest( "form" ).attr("id") == "taskForm" || element.parent().parent().parent().closest( "div" ).parent().parent().attr("id") == "more-info-dialog" ) { tip.addClass( "ui-icon ui-icon-check tips_error_msg" ); element.addClass( "ui-state-default" ); }
      element.removeClass( "ui-state-error" );
      return true;
    }
  }

//makes sure checkboxes are checked.
  function checkCheckBox(element,elementDisplayName, tip) { 
    if (element.find('input[type=checkbox]' ).is(':checked')) {
      if (element.closest( "form" ).attr("id") == "taskForm" || element.parent().parent().parent().closest( "div" ).parent().parent().attr("id") == "more-info-dialog" ) { tip.addClass( "ui-icon ui-icon-check tips_error_msg" ); element.addClass( "ui-state-default" ); }
      element.removeClass( "ui-state-error" );
      return true;
    } else {
      if (element.closest( "form" ).attr("id") == "taskForm" || element.parent().parent().parent().closest( "div" ).parent().parent().attr("id") == "more-info-dialog" ) { tip.removeClass( "ui-icon ui-icon-check" ); }
      element.addClass( "ui-state-error" );
//      element.focus();
      return elementDisplayName + " is required.";
    }
  }
//verify that array has items
  function checkArray(element,elementDisplayName,tip,array) {
    if(array.length > 0) {
      if (element.closest( "form" ).attr("id") == "taskForm" || element.parent().parent().parent().closest( "div" ).parent().parent().attr("id") == "more-info-dialog" ) { tip.addClass( "ui-icon ui-icon-check tips_error_msg" ); element.addClass( "ui-state-default" ); }
      element.removeClass( "ui-state-error" );
      return true;
    } else {
      if (element.closest( "form" ).attr("id") == "taskForm" || element.parent().parent().parent().closest( "div" ).parent().parent().attr("id") == "more-info-dialog" ) { tip.removeClass( "ui-icon ui-icon-check" ); }
      element.addClass( "ui-state-error" );
      element.removeClass( "ui-state-default" );
//      element.focus();
      return elementDisplayName + " is required.";
    }
  }
    
</script>